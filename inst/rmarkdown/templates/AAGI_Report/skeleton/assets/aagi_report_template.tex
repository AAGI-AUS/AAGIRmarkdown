% LaTeX template for AAGI Reports
% *Modified for use with the AAGIRmarkdown package.
% Date last modified: 03/12/2025

\documentclass[12pt]{article}

%% Configuration %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% (Modify these if you have a need to do so, or if you have additional
% packages that you need to load. Otherwise this configuration should
% be left as-is.)
\usepackage{lmodern}
\usepackage{microtype}
\usepackage[paper=a4paper,top=35mm,left=25mm,right=25mm,bottom=30mm]{geometry}
\usepackage{adjustbox}
\usepackage[title]{appendix}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{rotating}
\renewcommand{\familydefault}{\sfdefault}

% AAGI colours
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx}
\definecolor{aagiteal}{HTML}{00808b}
\definecolor{aagigreen}{HTML}{b6d438}
\definecolor{aagiblack}{HTML}{414042}

% Command definitions and settings copied over from the old AAGI.sty
\newcommand{\HRule}{\hspace{-25mm}\rule{160mm}{0.6mm}}
\setlength{\parindent}{0cm}
\setlength{\headheight}{2pt}
\setlength{\parskip}{2.5ex}
\setlength{\emergencystretch}{3em}
\DeclareOldFontCommand{\sbf}{\normalfont\bfseries\sffamily}{\mathsf}
\DeclareOldFontCommand{\tbf}{\normalfont\bfseries\ttfamily}{\mathtt}
\pagestyle{fancy}
\renewcommand{\sectionmark}[1]{\markboth{\thesection\hspace{2.5mm} #1}{}}
\fancyhf{}
\fancyhead[L]{\sffamily\leftmark}
\fancyfoot[C]{\sffamily \thepage}
\fancypagestyle{bibliography}{\fancyhead[L]{\sffamily References}}
\setlength{\headheight}{15pt}


% Colour tables + long tables
\usepackage{colortbl}

\usepackage{longtable}
\setlength{\LTcapwidth}{\textwidth}

% Figures configuration
\usepackage{caption}
\captionsetup{font={sf}}
\setlength{\fboxsep}{0pt}

% URL styling
\usepackage{url}

% FontAwesome icons
\usepackage{fontawesome5}

% Tikzpictures/PGFplots (if desired)
%\usepackage{tikz}
%\usepackage{pgfplots}
%\pgfplotsset{compat=newest}

% Listings for code (if desired)
%\usepackage{inconsolata}
%\usepackage{listings}
%\lstset{%
%  basicstyle=\footnotesize\ttfamily,
%  keywordstyle=\footnotesize\ttfamily,
%  language=R}


% A fancy coloured box for notes/warnings
\usepackage[most]{tcolorbox}
\newtcolorbox{note}[1][]{%
  colback=aagiteal!7, colframe=aagiteal!7, notitle, sharp corners,
  borderline west={2pt}{0pt}{aagiteal}, borderline east={2pt}{0pt}{aagiteal},
  enhanced, breakable}

% For Rmarkdown, we need to provide a tightlist command
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% For Rmarkdown we also need to fix up the CSLReferences environment
% for the bib references
% See: https://github.com/ismayc/thesisdown/issues/207#issuecomment-2320675775
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
\begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
% allow citations to break across lines
\let\@cite@ofmt\@firstofone
% avoid brackets around text for \cite:
\def\@biblabel#1{}
\def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
{\begin{list}{}{%
	\setlength{\itemindent}{0pt}
	\setlength{\leftmargin}{0pt}
	\setlength{\parsep}{0pt}
	% turn on hanging indent if param 1 is 1
	\ifodd #1
	\setlength{\leftmargin}{\cslhangindent}
	\setlength{\itemindent}{-1\cslhangindent}
	\fi
	% set entry spacing
	\setlength{\itemsep}{#2\baselineskip}}}
{\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

% We also need the Shaded environment and highlighting macros
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% And these packages help with the kable table formatting
\usepackage{booktabs}
\usepackage{float}

% Hyperref for links/cross-referencing
\usepackage{hyperref}
\hypersetup{%
  colorlinks=true, linkcolor=aagiteal, urlcolor=aagiteal, citecolor=aagiteal}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}
\def\appendixautorefname{Appendix}
\def\figureautorefname{Figure}
\def\tableautorefname{Table}

%% Document %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
  %% Title page
  \thispagestyle{empty}
  \vspace*{-30mm}
  \begin{center}
    \includegraphics[height=3cm]{assets/AAGI_logo.pdf}
  \end{center}
  \vspace*{2cm}
  \begin{flushright}
    \HRule\\[5mm]
    \adjustbox{tabular=@{}r@{}r@{},width=\linewidth}{%
      \color{aagiteal}\sbf Analytics for the Australian Grains Industry\\[1pt]
      \color{aagiteal}\sbf {$university$} ({$aagi-node$})\\[0pt]
      \color{aagiteal}\sbf {$program$} Report\\}\\[0pt]
    \vspace*{6mm}
    {\LARGE\sbf%
       $report-title$
    }\\[4pt]
    {\Large\sbf%
      Report for $project-code$
    }\\[8mm]

    \sf\normalsize
    Prepared for:
      $if(client)$
      $for(client)${$if(client.first)$\sbf$endif$$client$}\\$endfor$
      $endif$
    \vspace*{0.5cm}

    Prepared by:
      $if(author)$
        $for(author)${$if(author.first)$\sbf$endif$$author$}\\$endfor$
      $endif$
    \vspace*{0.5cm}

    Correspondence email:\; $correspondence-email$

    $report-date$\\[-2pt]
    \HRule
  \end{flushright}

  \vfill

  \noindent\makebox[\textwidth]{%
    \includegraphics[width=\paperwidth]{assets/Partners.pdf}}
  \vspace*{-36mm}

  \clearpage
  \pagestyle{plain}
  \setcounter{page}{1}
  \tableofcontents

  % Other lists of tables or figures (uncomment as desired)
  %\listoftables
  %\addcontentsline{toc}{chapter}{List of Tables}
  %\listoffigures
  %\addcontentsline{toc}{chapter}{List of Figures}

  %% Document proper
  $body$
\end{document}
